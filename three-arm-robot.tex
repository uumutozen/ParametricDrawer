\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumitem}
\usepackage[top=20mm,bottom=20mm,left=20mm,right=20mm]{geometry}
%\usepackage[pdfstartview=FitV,bookmarks=false]{hyperref}
%\usepackage[notref,notcite]{showkeys}

\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepackage{xfp}

\newtheorem{question}{Question}

\title{MAT 4070 (314S3) - Project}
\author{\empty}
\date{\today}

\begin{document}

\maketitle

\section{Three Axis Robotic Arm}

\begin{figure}[h!tb]
  \centering
  \tdplotsetmaincoords{60}{160} % Set the viewing angle
  %\tdplotsetmaincoords{0}{0} % Top View
  \begin{tikzpicture}[tdplot_main_coords,scale=1]
    \draw[->,dashed] (-1,0,0) -- (10,0,0) node[above] {$x$};
    \draw[->,dashed] (0,-5,0) -- (0,6,0) node[right] {$y$};
    \draw[->,dashed] (0,0,-1) -- (0,0,12) node[above] {$z$};
    \draw[very thick,dashed,blue] (0,0,0) -- (0,0,3);
    \node[anchor=west] at (0,0,1.5) {$d$};
    \draw[very thick,dashed,blue] (0,5,3) -- (0,5,11);
    \node[anchor=west] at (0,5,7) {$h$};
    \draw[very thick,dashed,blue] (0,5,11) -- (0,-5,11);
    \node[anchor=west] at (0,0,11) {$w$};
    \draw[thick] (0,5,3) -- ++(0,-10,0) -- ++(0,0,8) -- ++(0,10,0) -- cycle;
    \fill[red] (5,0,1) circle (3pt);
    \node[anchor=south west] at (5,0,1) {$(x_{0},y_{0},z_{0})$};
    \fill[red] (8.69,-2.02,3.70) circle (3pt);
    \node[anchor=east] at (8.69,-2.02,3.70) {$(x_{1},y_{1},z_{1})$};
    \draw[thick] (5,0,1) -- (8.69,-2.02,3.70);
    \node[anchor=south west] at (6.845,-1.01,2.35) {$L_{1}$};
    \fill[red,opacity=0.3] (5,0,3.70) circle (3pt); % (x_{1},y_{0},z_{1})
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (5,0,3.70) -- (8.69,-2.02,3.70); %Phi_1
    \fill[red,opacity=0.3] (8.69,-2.02,1) circle (3pt); % (x_{1},y_{1},z_{0})
    \draw[thick,opacity=0.3] (5,0,1) -- (8.69,-2.02,1); % L_{1}^{\prime}
    \draw[dashed,thick,opacity=0.3] (8.69,-2.02,1) -- (8.69,-2.02,3.70);
    %\draw[thick,opacity=0.3] (8.69,-2.02,1.5) -- (8.25142,-1.77991,1.5) -- (8.25142,-1.77991,1); %Perpendicular Sign
    %\fill[black,opacity=0.3] (8.47071,-1.89995,1.25) circle (1.5pt);
    \fill[red,opacity=0.3] (8.69,0,1) circle (3pt); % (x_{1},y_{0},z_{0})
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (8.69,0,1) -- (8.69,-2.02,1); %Theta
    \draw[thick,red,domain=4.21153:4.71239,samples=100,smooth,variable=\theta]
        plot ({5-0.5*sin(\theta r)},{0.5*cos(\theta r)},{1});
    \node[anchor=east,red] at (5.4844,-0.12391,1) {$\theta$};
    \draw[thick,red,domain=1.5708:2.5709822362803787,samples=100,smooth,variable=\phi]
        plot ({5-0.438584*cos(\phi r)},{0.240092*cos(\phi r)},{1+0.5*sin(\phi r)});
    \node[anchor=south east,red] at (5.2103,-0.115126,1.43877) {$\varphi_{1}$};
    \fill[red,opacity=0.3] (1.31,2.02,1) circle (3pt); % (x_{2},y_{2},z_{0})
    \draw[thick,opacity=0.3] (8.69,-2.02,1) -- (1.31,2.02,1); % L_{2}^{\prime}
    \draw[dashed,thick,opacity=0.3] (1.31,2.02,1) -- (1.31,2.02,9.10);
    \fill[red,opacity=0.3] (8.69,-2.02,9.10) circle (3pt); % (x_{1},y_{1},z_{2})
    \draw[dashed,thick,opacity=0.3] (8.69,-2.02,3.70) -- (8.69,-2.02,9.10) -- (1.31,2.02,9.10); %Phi_2
    \draw[thick,red,domain=0.57061:1.5708,samples=100,smooth,variable=\phi]
        plot ({8.69-0.438584*cos(\phi r)},{-2.02+0.240092*cos(\phi r)},{3.7+0.5*sin(\phi r)});
    \node[anchor=south,red] at (8.4797,-1.90487,4.13877) {$\varphi_{2}$};
    \fill[red] (1.31,2.02,9.10) circle (3pt);
    \node[anchor=south east] at (1.31,2.02,9.10) {$(x_{2},y_{2},z_{2})$};
    \node[anchor=south east] at (5,0,6.4) {$L_{2}$};
    \draw[thick] (8.69,-2.02,3.70) -- (1.31,2.02,9.10);
  \end{tikzpicture}
  %\caption{}\label{}
\end{figure}

%\begin{figure}[h!tb]
%  \centering
%  \tdplotsetmaincoords{0}{0} % Set the viewing angle
%  \begin{tikzpicture}[tdplot_main_coords,scale=1]
%    \draw[->,dashed] (0,-1,0) -- (0,10,0) node[above] {$x$};
%    \draw[->,dashed] (5,0,0) -- (-6,0,0) node[right] {$y$};
%    \draw[->,dashed] (0,0,-1) -- (0,0,12) node[above] {$z$};
%    \draw[very thick,dashed,blue] (0,0,0) -- (0,0,3);
%    \node[anchor=west] at (0,0,1.5) {$d$};
%    \draw[very thick,dashed,blue] (5,0,3) -- (5,0,11);
%    \node[anchor=west] at (5,0,7) {$h$};
%    \draw[very thick,dashed,blue] (5,0,11) -- (-5,0,11);
%    \node[anchor=west] at (0,0,11) {$w$};
%    \draw[thick] (5,0,3) -- (-5,0,3) -- (-5,0,8+3) -- (5,0,8+3) -- cycle;
%    \fill[red] (0,5,1) circle (3pt);
%    \node[anchor=west] at (0,5.00,1.00) {$(x_{0},y_{0},z_{0})$};
%    \fill[red] (-2.02,8.69,3.70) circle (3pt);
%    \node[anchor=east] at (-2.02,8.69,3.70) {$(x_{1},y_{1},z_{1})$};
%    \fill[red] (2.02,1.31,9.10) circle (3pt);
%    \node[anchor=south east] at (2.02,1.31,9.10) {$(x_{2},y_{2},z_{2})$};
%    \draw[thick] (0,5,1) -- (-2.02,8.69,3.70) -- (2.02,1.31,9.10);
%    \node[anchor=south west] at (-1.01,6.845,2.35) {$L_{1}$};
%    \draw[dashed] (0,5,1) -- ++(0,0,2); %Phi_1
%    \fill[red,opacity=0.3] (-2.02,8.69,1) circle (3pt); % (x_{1},y_{1},z_{0})
%    \draw[thick,opacity=0.3] (0,5,1) -- (-2.02,8.69,1); % L_{1}^{\prime}
%    \draw[dashed,thick,opacity=0.3] (-2.02,8.69,1) -- (-2.02,8.69,3.70);
%    \draw[thick,opacity=0.3] (-2.02,8.69,1.5) -- (-1.77991,8.25142,1.5) -- (-1.77991,8.25142,1); %Perpendicular Sign
%    \fill[black,opacity=0.3] (-1.89995,8.47071,1.25) circle (1.5pt);
%    \draw[dashed] (0,5,1) -- ++(0,2,0); %Theta
%    \draw[thick,red,domain=4.21153:4.71239,samples=100,smooth,variable=\theta]
%        plot ({0.5*cos(\theta r)},{5-0.5*sin(\theta r)},{1});
%    \node[anchor=east,red] at (-0.12391,5.4844,1) {$\theta$};
%    %\draw[thick,red,domain=3.14159:4.21153,samples=100,smooth,variable=\theta]
%    %    plot ({0.5*cos(\theta r)},{5-0.5*sin(\theta r)},{1});
%    %\node[anchor=north east,red] at (-0.370045,5.21929,1) {$\theta$};
%
%    \draw[thick,red,domain=1.5708:2.5709822362803787,samples=100,smooth,variable=\phi]
%        plot ({0.240092*cos(\phi r)},{5-0.438584*cos(\phi r)},{1+0.5*sin(\phi r)});
%    \node[anchor=south east,red] at (-0.115126,5.2103,1.43877) {$\varphi_{1}$};
%
%    \node[anchor=south east] at (0,5,6.4) {$L_{2}$};
%    \fill[red,opacity=0.3] (2.02,1.31,1) circle (3pt); % (x_{2},y_{2},z_{0})
%    \draw[thick,opacity=0.3] (-2.02,8.69,1) -- (2.02,1.31,1); % L_{2}^{\prime}
%    \draw[dashed,thick,opacity=0.3] (2.02,1.31,1) -- (2.02,1.31,9.10);
%    \draw[dashed] (-2.02,8.69,3.70) -- ++(0,0,2); %Phi_2
%    \draw[thick,red,domain=0.57061:1.5708,samples=100,smooth,variable=\phi]
%        plot ({-2.02+0.240092*cos(\phi r)},{8.69-0.438584*cos(\phi r)},{3.7+0.5*sin(\phi r)});
%    \node[anchor=south,red] at (-1.90487,8.4797,4.13877) {$\varphi_{2}$};
%  \end{tikzpicture}
%  %\caption{}\label{}
%\end{figure}


Let $(x_{0},y_{0},z_{0})$ denote the base point of the arm,
and $L_{1}$ and $L_{2}$ be the length of the links.
Further, let $\varphi_{i}$ denote the angle between $y$-axes and the link $L_{i}$ ($i=1,2$),
and $\theta$ denote the angle between $z$-axes and the $xz$-projection of $L_{1}$.

\begin{question}
Compute the coordinates of the points $(x_{1},y_{1},z_{1})$ and $(x_{2},y_{2},z_{2})$ in terms of $x_{0},y_{0},z_{0},\theta,\varphi_{1},L_{1},\varphi_{2},L_{2}$.
\begin{align}
\left\{
\begin{aligned}[]
x_{1}={}&x_{0}+L_{1}\sin(\varphi_{1})\cos(\theta)\\
y_{1}={}&y_{0}-L_{1}\sin(\varphi_{1})\sin(\theta)\\
z_{1}={}&z_{0}+L_{1}\cos(\varphi_{1})
\end{aligned}
\right.\nonumber\\
\left\{
\begin{aligned}[]
x_{2}={}&x_{1}-L_{2}\sin(\varphi_{2})\cos(\theta)\\
y_{2}={}&y_{1}+L_{2}\sin(\varphi_{2})\sin(\theta)\\
z_{2}={}&z_{1}+L_{2}\cos(\varphi_{2}).
\end{aligned}\right.\nonumber
\end{align}
Explicitly, we have
\begin{equation}
\left\{
\begin{aligned}[]
x_{2}={}&x_{0}+\bigl[L_{1}\sin(\varphi_{1})-L_{2}\sin(\varphi_{2})\bigr]\cos(\theta)\\
y_{2}={}&y_{0}-\bigl[L_{1}\sin(\varphi_{1})-L_{2}\sin(\varphi_{2})\bigr]\sin(\theta)\\
z_{2}={}&z_{0}+L_{1}\cos(\varphi_{1})+L_{2}\cos(\varphi_{2}).
\end{aligned}\right.\nonumber
\end{equation}
\end{question}


\begin{question}
Under which restrictions $(x_{2},y_{2},z_{2})$ belongs to the white board
(i.e., $x_{2}=0$, $-\frac{w}{2}\leq{}y_{2}\leq\frac{w}{2}$ and $d\leq{}z_{2}\leq{}d+h$)?
Find ranges for $\theta,\varphi_{1},\varphi_{2}$.
\end{question}

\begin{align}
\phantom{\implies}
\left\{
\begin{aligned}[]
x_{1}-x_{0}={}&L_{1}\sin(\varphi_{1})\cos(\theta)\\
-(y_{1}-y_{0})={}&L_{1}\sin(\varphi_{1})\sin(\theta)\\
z_{1}-z_{0}={}&L_{1}\cos(\varphi_{1})
\end{aligned}
\right.\nonumber\\
\left\{
\begin{aligned}[]
-(x_{2}-x_{1})={}&L_{2}\sin(\varphi_{2})\cos(\theta)\\
y_{2}-y_{1}={}&L_{2}\sin(\varphi_{2})\sin(\theta)\\
z_{2}-z_{1}={}&L_{2}\cos(\varphi_{2}).
\end{aligned}\right.\nonumber\\
\implies
\left\{
\begin{aligned}[]
\tan(\theta)={}&-\frac{y_{1}-y_{0}}{x_{1}-x_{0}}\\
\tan(\varphi_{1})={}&\frac{x_{1}-x_{0}}{z_{1}-z_{0}}\sec(\theta)
\end{aligned}\right.\nonumber\\
\left\{
\begin{aligned}[]
\tan(\theta)={}&-\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\
\tan(\varphi_{2})={}&\frac{y_{2}-y_{1}}{z_{2}-z_{1}}\csc(\theta)
\end{aligned}\right.\nonumber\\
\implies
\left\{
\begin{aligned}[]
\theta={}&-\arctan\Biggl(\frac{y_{1}-y_{0}}{x_{1}-x_{0}}\Biggr)\\
\theta={}&-\arctan\Biggl(\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\Biggr)\\
\theta={}&-\arctan\Biggl(\frac{y_{2}-y_{0}}{x_{2}-x_{0}}\Biggr)\\
\varphi_{1}={}&\arctan\Biggl(\frac{x_{1}-x_{0}}{z_{1}-z_{0}}\sec(\theta)\Biggr)\\
\varphi_{2}={}&\arctan\Biggl(\frac{y_{2}-y_{1}}{z_{2}-z_{1}}\csc(\theta)\Biggr)
\end{aligned}\right.\nonumber
\end{align}

\begin{question}
For the point $(0,y,z)$ belonging to the white board, compute $\theta,\varphi_{1},\varphi_{2}$.
\end{question}


\begin{figure}[h!tb]
  \centering
  \tdplotsetmaincoords{60}{160} % Set the viewing angle
  %\tdplotsetmaincoords{0}{0} % Top View
  \begin{tikzpicture}[tdplot_main_coords,scale=1]
    \draw[->,dashed] (-1,0,0) -- (10,0,0) node[above] {$x$};
    \draw[->,dashed] (0,-5,0) -- (0,6,0) node[right] {$y$};
    \draw[->,dashed] (0,0,-1) -- (0,0,12) node[above] {$z$};
    \draw[very thick,dashed,blue] (0,0,0) -- (0,0,3);
    \node[anchor=west] at (0,0,1.5) {$d$};
    \draw[very thick,dashed,blue] (0,5,3) -- (0,5,11);
    \node[anchor=west] at (0,5,7) {$h$};
    \draw[very thick,dashed,blue] (0,5,11) -- (0,-5,11);
    \node[anchor=west] at (0,0,11) {$w$};
    \draw[thick] (0,5,3) -- ++(0,-10,0) -- ++(0,0,8) -- ++(0,10,0) -- cycle;
    \fill[red] (5,0,1) circle (3pt);
    \node[anchor=south west] at (5,0,1) {$(x_{0},y_{0},z_{0})$};
    \fill[red] (8.69,-2.02,3.70) circle (3pt);
    \node[anchor=east] at (8.69,-2.02,3.70) {$(x_{1},y_{1},z_{1})$};
    \draw[thick] (5,0,1) -- (8.69,-2.02,3.70);
    \node[anchor=south west] at (6.845,-1.01,2.35) {$L_{1}$};
    \fill[red,opacity=0.3] (5,0,3.70) circle (3pt); % (x_{1},y_{0},z_{1})
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (5,0,3.70) -- (8.69,-2.02,3.70); %Phi_1
    \fill[red,opacity=0.3] (8.69,-2.02,1) circle (3pt); % (x_{1},y_{1},z_{0})
    \draw[thick,opacity=0.3] (5,0,1) -- (8.69,-2.02,1); % L_{1}^{\prime}
    \draw[dashed,thick,opacity=0.3] (8.69,-2.02,1) -- (8.69,-2.02,3.70);
    %\draw[thick,opacity=0.3] (8.69,-2.02,1.5) -- (8.25142,-1.77991,1.5) -- (8.25142,-1.77991,1); %Perpendicular Sign
    %\fill[black,opacity=0.3] (8.47071,-1.89995,1.25) circle (1.5pt);
    \fill[red,opacity=0.3] (8.69,0,1) circle (3pt); % (x_{1},y_{0},z_{0})
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (8.69,0,1) -- (8.69,-2.02,1); %Theta
    \draw[thick,red,domain=4.21153:4.71239,samples=100,smooth,variable=\theta]
        plot ({5-0.5*sin(\theta r)},{0.5*cos(\theta r)},{1});
    \node[anchor=east,red] at (5.4844,-0.12391,1) {$\theta$};
    \draw[thick,red,domain=1.5708:2.5709822362803787,samples=100,smooth,variable=\phi]
        plot ({5-0.438584*cos(\phi r)},{0.240092*cos(\phi r)},{1+0.5*sin(\phi r)});
    \node[anchor=south east,red] at (5.2103,-0.115126,1.43877) {$\varphi_{1}$};
    \fill[red,opacity=0.3] (1.31,2.02,1) circle (3pt); % (x_{2},y_{2},z_{0})
    \draw[thick,opacity=0.3] (8.69,-2.02,1) -- (1.31,2.02,1); % L_{2}^{\prime}
    \draw[dashed,thick,opacity=0.3] (1.31,2.02,1) -- (1.31,2.02,9.10);
    \fill[red,opacity=0.3] (8.69,-2.02,9.10) circle (3pt); % (x_{1},y_{1},z_{2})
    \draw[dashed,thick,opacity=0.3] (8.69,-2.02,3.70) -- (8.69,-2.02,9.10) -- (1.31,2.02,9.10); %Phi_2
    \draw[thick,red,domain=0.57061:1.5708,samples=100,smooth,variable=\phi]
        plot ({8.69-0.438584*cos(\phi r)},{-2.02+0.240092*cos(\phi r)},{3.7+0.5*sin(\phi r)});
    \node[anchor=south,red] at (8.4797,-1.90487,4.13877) {$\varphi_{2}$};
    \fill[red] (1.31,2.02,9.10) circle (3pt);
    \node[anchor=south east] at (1.31,2.02,9.10) {$(x_{2},y_{2},z_{2})$};
    \node[anchor=south east] at (5,0,6.4) {$L_{2}$};
    \draw[thick] (8.69,-2.02,3.70) -- (1.31,2.02,9.10);
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (5,2.02,1) -- (1.31,2.02,1); %Theta
  \end{tikzpicture}
  %\caption{}\label{}
\end{figure}


\begin{figure}[h!tb]
  \centering
  \tdplotsetmaincoords{90}{151.3} % Set the viewing angle
  %\tdplotsetmaincoords{0}{0} % Top View
  \begin{tikzpicture}[tdplot_main_coords,scale=1]
    \draw[->,dashed] (-1,0,0) -- (10,0,0) node[above] {$x$};
    \draw[->,dashed] (0,-5,0) -- (0,6,0) node[right] {$y$};
    \draw[->,dashed] (0,0,-1) -- (0,0,12) node[above] {$z$};
    %\draw[very thick,dashed,blue] (0,0,0) -- (0,0,3);
    %\node[anchor=west] at (0,0,1.5) {$d$};
    %\draw[very thick,dashed,blue] (0,5,3) -- (0,5,11);
    %\node[anchor=west] at (0,5,7) {$h$};
    %\draw[very thick,dashed,blue] (0,5,11) -- (0,-5,11);
    %\node[anchor=west] at (0,0,11) {$w$};
    %\draw[thick] (0,5,3) -- ++(0,-10,0) -- ++(0,0,8) -- ++(0,10,0) -- cycle;
    \fill[red] (5,0,1) circle (3pt);
    \node[anchor=south west] at (5,0,1) {$(x_{0},y_{0},z_{0})$};
    \fill[red] (8.69,-2.02,3.70) circle (3pt);
    \node[anchor=east] at (8.69,-2.02,3.70) {$(x_{1},y_{1},z_{1})$};
    \draw[thick] (5,0,1) -- (8.69,-2.02,3.70);
    \node[anchor=south west] at (6.845,-1.01,2.35) {$L_{1}$};
    \fill[red,opacity=0.3] (5,0,3.70) circle (3pt); % (x_{1},y_{0},z_{1})
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (5,0,3.70) -- (8.69,-2.02,3.70); %Phi_1
    \fill[red,opacity=0.3] (8.69,-2.02,1) circle (3pt); % (x_{1},y_{1},z_{0})
    \draw[thick,opacity=0.3] (5,0,1) -- (8.69,-2.02,1); % L_{1}^{\prime}
    \draw[dashed,thick,opacity=0.3] (8.69,-2.02,1) -- (8.69,-2.02,3.70);
    %\draw[thick,opacity=0.3] (8.69,-2.02,1.5) -- (8.25142,-1.77991,1.5) -- (8.25142,-1.77991,1); %Perpendicular Sign
    %\fill[black,opacity=0.3] (8.47071,-1.89995,1.25) circle (1.5pt);
    \fill[red,opacity=0.3] (8.69,0,1) circle (3pt); % (x_{1},y_{0},z_{0})
    \draw[dashed,thick,opacity=0.3] (5,0,1) -- (8.69,0,1) -- (8.69,-2.02,1); %Theta
    \draw[thick,red,domain=4.21153:4.71239,samples=100,smooth,variable=\theta]
        plot ({5-0.5*sin(\theta r)},{0.5*cos(\theta r)},{1});
    \node[anchor=east,red] at (5.4844,-0.12391,1) {$\theta$};
    \draw[thick,red,domain=1.5708:2.5709822362803787,samples=100,smooth,variable=\phi]
        plot ({5-0.438584*cos(\phi r)},{0.240092*cos(\phi r)},{1+0.5*sin(\phi r)});
    \node[anchor=south east,red] at (5.2103,-0.115126,1.43877) {$\varphi_{1}$};
    \fill[red,opacity=0.3] (1.31,2.02,1) circle (3pt); % (x_{2},y_{2},z_{0})
    \draw[thick,opacity=0.3] (8.69,-2.02,1) -- (1.31,2.02,1); % L_{2}^{\prime}
    \draw[dashed,thick,opacity=0.3] (1.31,2.02,1) -- (1.31,2.02,9.10);
    \fill[red,opacity=0.3] (8.69,-2.02,9.10) circle (3pt); % (x_{1},y_{1},z_{2})
    \draw[dashed,thick,opacity=0.3] (8.69,-2.02,3.70) -- (8.69,-2.02,9.10) -- (1.31,2.02,9.10); %Phi_2
    \draw[thick,red,domain=0.57061:1.5708,samples=100,smooth,variable=\phi]
        plot ({8.69-0.438584*cos(\phi r)},{-2.02+0.240092*cos(\phi r)},{3.7+0.5*sin(\phi r)});
    \node[anchor=south,red] at (8.4797,-1.90487,4.13877) {$\varphi_{2}$};
    \fill[red] (1.31,2.02,9.10) circle (3pt);
    \node[anchor=south east] at (1.31,2.02,9.10) {$(x_{2},y_{2},z_{2})$};
    \node[anchor=south east] at (5,0,6.4) {$L_{2}$};
    \draw[thick] (8.69,-2.02,3.70) -- (1.31,2.02,9.10);
    \draw[dashed,thick] (5,0,1) -- (1.31,2.02,9.10);
    \node[anchor=east] at (3.155,1.01,5.05) {$L_{3}$};
    \draw[thick,red,domain=4.71239:5.71257,samples=100,smooth,variable=\phi]
        plot ({8.69-0.438584*cos(\phi r)},{-2.02+0.240092*cos(\phi r)},{3.7+0.5*sin(\phi r)});
    \node[anchor=north,red] at (8.4797,-1.90487,3.26123) {$\varphi_{1}$};
  \end{tikzpicture}
  %\caption{}\label{}
\end{figure}

\begin{gather}
L_{3}^{2}=(x_{2}-x_{0})^{2}+(y_{2}-y_{0})^{2}+(z_{2}-z_{0})^{2}\nonumber\\
L_{1}^{2}+2L_{2}L_{3}\cos(\alpha)=L_{2}^{2}+L_{3}^{2}\nonumber\\
L_{2}^{2}+2L_{1}L_{3}\cos(\beta)=L_{1}^{2}+L_{3}^{2}\nonumber
\end{gather}

\begin{align}
\alpha={}&\arccos\Biggl(\frac{L_{2}^{2}+L_{3}^{2}-L_{1}^{2}}{2L_{2}L_{3}}\biggr)\nonumber\\
\beta={}&\arccos\Biggl(\frac{L_{1}^{2}+L_{3}^{2}-L_{2}^{2}}{2L_{1}L_{3}}\biggr)\nonumber\\
\delta={}&\arccos\Biggl(\frac{|z_{2}-z_{0}|}{L_{3}}\Biggr)\nonumber\\
%\delta={}&\arctan\biggl(\frac{\sqrt{(x_{2}-x_{0})^{2}+(y_{2}-y_{0})^{2}}}{|z_{2}-z_{0}|}\biggr)\nonumber\\
\varphi_{2}={}&\alpha+\delta\nonumber\\
\varphi_{1}={}&\beta-\delta\nonumber
\end{align}

\end{document}
